<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="452px" preserveAspectRatio="none" style="width:811px;height:452px;background:#FFFFFF;" version="1.1" viewBox="0 0 811 452" width="811px" zoomAndPan="magnify"><title>Alerts POST (Idempotent Creation)</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="275.2695" x="267.3469" y="27.9951">Alerts POST (Idempotent Creation)</text><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="253.0625" width="8" x="24.2651" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="28" x2="28" y1="118.5938" y2="371.6563"/></g><g><title>API Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="253.0625" width="8" x="327.7969" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="331.5752" x2="331.5752" y1="118.5938" y2="371.6563"/></g><g><title>Alerts Service</title><rect fill="#000000" fill-opacity="0.00000" height="253.0625" width="8" x="520.9619" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="524.5566" x2="524.5566" y1="118.5938" y2="371.6563"/></g><g><title>Database</title><rect fill="#000000" fill-opacity="0.00000" height="253.0625" width="8" x="761.563" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="765.1626" x2="765.1626" y1="118.5938" y2="371.6563"/></g><g class="participant participant-head" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="5" y="115.292">Client</text><ellipse cx="28.2651" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.2651,58.7969 L28.2651,85.7969 M15.2651,66.7969 L41.2651,66.7969 M28.2651,85.7969 L15.2651,100.7969 M28.2651,85.7969 L41.2651,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="Client"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="5" y="383.6514">Client</text><ellipse cx="28.2651" cy="395.4531" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M28.2651,403.4531 L28.2651,430.4531 M15.2651,411.4531 L41.2651,411.4531 M28.2651,430.4531 L15.2651,445.4531 M28.2651,430.4531 L41.2651,445.4531" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="280.5752" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="287.5752" y="107.292">API Gateway</text></g><g class="participant participant-tail" data-participant="API"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="280.5752" y="370.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="287.5752" y="390.6514">API Gateway</text></g><g class="participant participant-head" data-participant="Service"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.8105" x="469.5566" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.8105" x="476.5566" y="107.292">Alerts Service</text></g><g class="participant participant-tail" data-participant="Service"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="110.8105" x="469.5566" y="370.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.8105" x="476.5566" y="390.6514">Alerts Service</text></g><g class="participant participant-head" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="725.1626" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="732.1626" y="107.292">Database</text></g><g class="participant participant-tail" data-participant="DB"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.8008" x="725.1626" y="370.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.8008" x="732.1626" y="390.6514">Database</text></g><g class="message" data-participant-1="Client" data-participant-2="API"><polygon fill="#181818" points="319.7969,145.7266,329.7969,149.7266,319.7969,153.7266,323.7969,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.2651" x2="325.7969" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.5317" x="35.2651" y="144.6606">POST /v1/alerts (body + Idempotency-Key)</text></g><g class="message" data-participant-1="API" data-participant-2="Service"><polygon fill="#181818" points="512.9619,174.8594,522.9619,178.8594,512.9619,182.8594,516.9619,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="331.7969" x2="518.9619" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.1582" x="338.7969" y="173.7935">Check Idempotency-Key</text></g><g class="message" data-participant-1="Service" data-participant-2="DB"><polygon fill="#181818" points="753.563,203.9922,763.563,207.9922,753.563,211.9922,757.563,207.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="524.9619" x2="759.563" y1="207.9922" y2="207.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6011" x="531.9619" y="202.9263">Lookup key in idempotency table</text></g><g class="message" data-participant-1="DB" data-participant-2="Service"><polygon fill="#181818" points="535.9619,233.125,525.9619,237.125,535.9619,241.125,531.9619,237.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="529.9619" x2="764.563" y1="237.125" y2="237.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0054" x="541.9619" y="232.0591">Key exists? No</text></g><g class="message" data-participant-1="Service" data-participant-2="DB"><polygon fill="#181818" points="753.563,262.2578,763.563,266.2578,753.563,270.2578,757.563,266.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="524.9619" x2="759.563" y1="266.2578" y2="266.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2217" x="531.9619" y="261.1919">Insert new alert, store key</text></g><g class="message" data-participant-1="DB" data-participant-2="Service"><polygon fill="#181818" points="535.9619,291.3906,525.9619,295.3906,535.9619,299.3906,531.9619,295.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="529.9619" x2="764.563" y1="295.3906" y2="295.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.8809" x="541.9619" y="290.3247">Alert created</text></g><g class="message" data-participant-1="Service" data-participant-2="API"><polygon fill="#181818" points="342.7969,320.5234,332.7969,324.5234,342.7969,328.5234,338.7969,324.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="336.7969" x2="523.9619" y1="324.5234" y2="324.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.165" x="348.7969" y="319.4575">201 Created (alert object)</text></g><g class="message" data-participant-1="API" data-participant-2="Client"><polygon fill="#181818" points="39.2651,349.6563,29.2651,353.6563,39.2651,357.6563,35.2651,353.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="33.2651" x2="330.7969" y1="353.6563" y2="353.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.0195" x="45.2651" y="348.5903">Response</text></g><!--SRC=[PP7BJiCm44Nt_eghhb91LCgo2r2RI2W2GKNv0SSP2PDWH_7Gahzd4eTMRNT-79-vCsRB3M7TKCS1sxVT1vAYek_MCpb6rf5cwzrSAMtOTyWQA-UgrHrROrijp6ozBV2acGwwdq47oFu2YFOTTNjhQ6IczJcNQzQb3f78Dqh5QaWV1YTMCTzYlrpeQ4nAN_MumJ6nwTDdwkTgmENLL4LUPfzawajE_TyBcc-4Ul6-_cbHKm_hO4yq95X3Ig3qJ2iIqAyD71xnwgzyXGkI4uuE61FV8iWGQIXmxHgd13DCdAgJwjZy_Tqo_WTLI4OTVFb5XgTs1PpcjS8xXTPByJy0]--></g></svg>